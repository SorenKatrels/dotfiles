# This file has been auto-generated by i3-config-wizard(1).
# It will not be overwritten, so edit it as you like.
#
# Should you change your keyboard layout some time, delete
# this file and re-run i3-config-wizard(1).
#

# i3 config file (v4)
#
# Please see https://i3wm.org/docs/userguide.html for a complete reference!

set $mod Mod4

# Font for window titles. Will also be used by the bar unless a different font
# is used in the bar {} block below.
# font pango:monospace 8

# This font is widely installed, provides lots of unicode glyphs, right-to-left
# text rendering and scalability on retina/hidpi displays (thanks to pango).
font pango:Noto Sans 8

# The combination of xss-lock, nm-applet and pactl is a popular choice, so
# they are included here as an example. Modify as you see fit.

# xss-lock grabs a logind suspend inhibit lock and will use i3lock to lock the
# screen before suspend. Use loginctl lock-session to lock your screen.
exec --no-startup-id xss-lock --transfer-sleep-lock -- i3lock --nofork -i /usr/share/backgrounds/noise_bg.png

# NetworkManager is the most popular way to manage wireless networks on Linux,
# and nm-applet is a desktop environment-independent system tray GUI for it.
# exec --no-startup-id nm-applet

# Use pactl to adjust volume in PulseAudio.
bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ +1% && dunstify -t 1500 -r 2593 -u normal "Volume = $(amixer get Master | grep '%' | tail -n 1 | cut -d 'k' -f 2 | cut -d '[' -f 1)"
bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ -1% && dunstify -t 1500 -r 2593 -u normal "Volume = $(amixer get Master | grep '%' | tail -n 1 | cut -d 'k' -f 2 | cut -d '[' -f 1)"
bindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute @DEFAULT_SINK@ toggle && dunstify -t 1500 -r 2594 -u normal "$(pactl get-sink-mute @DEFAULT_SINK@)"
bindsym Shift+XF86AudioMute exec --no-startup-id pactl set-source-mute @DEFAULT_SOURCE@ toggle && dunstify -t 1500 -r 2595 -u normal "Mic $(pactl get-source-mute @DEFAULT_SOURCE@)"

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

# start a terminal
bindsym $mod+Return exec i3-sensible-terminal

# ssh into raspberry pi
bindsym $mod+Shift+Return exec i3-sensible-terminal --command ssh pi@192.168.1.200

# kill focused window
bindsym $mod+q kill

# start dmenu (a program launcher)
bindsym $mod+Shift+d exec --no-startup-id dmenu_run

# change focus
# bindsym $mod+Left focus left
# bindsym $mod+Down focus down
# bindsym $mod+Up focus up
# bindsym $mod+Right focus right

# move focused window
# bindsym $mod+Shift+Left move left
# bindsym $mod+Shift+Down move down
# bindsym $mod+Shift+Up move up
# bindsym $mod+Shift+Right move right

# split in horizontal orientation
bindsym $mod+h split h

# split in vertical orientation
bindsym $mod+v split v

# enter fullscreen mode for the focused container
bindsym XF86LaunchA fullscreen toggle

# change container layout (stacked, tabbed, toggle split)
# bindsym $mod+s layout stacking
# bindsym $mod+w layout tabbed
# bindsym $mod+e layout toggle split

# toggle tiling / floating
bindsym $mod+space floating toggle

# change focus between tiling / floating windows
# bindsym $mod+space focus mode_toggle

# focus the parent container
bindsym $mod+a focus parent

# focus the child container
#bindsym $mod+d focus child

# Define names for default workspaces for which we configure key bindings later on.
# We use variables to avoid repeating the names in multiple places.
set $ws1 "1"
set $ws2 "2"
set $ws3 "3"
set $ws4 "4"
set $ws5 "5"
set $ws6 "6"
set $ws7 "7"
set $ws8 "8"
set $ws9 "9"
set $ws10 "10"

# switch to workspace
bindsym $mod+1 workspace number $ws1
bindsym $mod+2 workspace number $ws2
bindsym $mod+3 workspace number $ws3
bindsym $mod+4 workspace number $ws4
bindsym $mod+5 workspace number $ws5
bindsym $mod+6 workspace number $ws6
bindsym $mod+7 workspace number $ws7
bindsym $mod+8 workspace number $ws8
bindsym $mod+9 workspace number $ws9
bindsym $mod+0 workspace number $ws10
# this is so fucking stupid
bindsym $mod+Right exec i3-msg workspace "$(expr $(i3-msg -t get_workspaces | jq -r '.[] | select(.focused==true).name') + 1)"
bindsym $mod+k exec i3-msg workspace "$(expr $(i3-msg -t get_workspaces | jq -r '.[] | select(.focused==true).name') + 1)"
bindsym $mod+Left workspace prev
bindsym $mod+j workspace prev

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace number $ws1 ; workspace number $ws1
bindsym $mod+Shift+2 move container to workspace number $ws2 ; workspace number $ws2
bindsym $mod+Shift+3 move container to workspace number $ws3 ; workspace number $ws3
bindsym $mod+Shift+4 move container to workspace number $ws4 ; workspace number $ws4
bindsym $mod+Shift+5 move container to workspace number $ws5 ; workspace number $ws5
bindsym $mod+Shift+6 move container to workspace number $ws6 ; workspace number $ws6
bindsym $mod+Shift+7 move container to workspace number $ws7 ; workspace number $ws7
bindsym $mod+Shift+8 move container to workspace number $ws8 ; workspace number $ws8
bindsym $mod+Shift+9 move container to workspace number $ws9 ; workspace number $ws9
bindsym $mod+Shift+0 move container to workspace number $ws10 ; workspace number $ws10
bindsym $mod+Shift+Right exec i3-msg move container to workspace "$(expr $(i3-msg -t get_workspaces | jq -r '.[] | select(.focused==true).name') + 1)"
bindsym $mod+Shift+k exec i3-msg move container to workspace "$(expr $(i3-msg -t get_workspaces | jq -r '.[] | select(.focused==true).name') + 1)"
bindsym $mod+Shift+Left exec i3-msg move container to workspace "$(expr $(i3-msg -t get_workspaces | jq -r '.[] | select(.focused==true).name') - 1)"
bindsym $mod+Shift+j exec i3-msg move container to workspace "$(expr $(i3-msg -t get_workspaces | jq -r '.[] | select(.focused==true).name') - 1)"

# restart i3
bindsym $mod+Shift+r restart

# reload config
bindsym $mod+c reload

# resize window (you can also use the mouse for that)
mode "resize" {
        # These bindings trigger as soon as you enter the resize mode

        # Pressing left will shrink the window’s width.
        # Pressing right will grow the window’s width.
        # Pressing up will shrink the window’s height.
        # Pressing down will grow the window’s height.
        bindsym Left resize shrink width 10 px or 10 ppt
        bindsym Down resize grow height 10 px or 10 ppt
        bindsym Up resize shrink height 10 px or 10 ppt
        bindsym Right resize grow width 10 px or 10 ppt

        bindsym Shift+Left move left
        bindsym Shift+Down move down
        bindsym Shift+Up move up
        bindsym Shift+Right move right

        # back to normal: Enter or Escape or $mod+r
        bindsym Return mode "default"
        bindsym Escape mode "default"
        bindsym $mod+r mode "default"
}

bindsym $mod+r mode "resize"

# Start i3bar
bar {
        position top
        status_command i3status
        mode hide

}

bindsym $mod+BackSpace bar hidden_state toggle
bindsym XF86LaunchB bar hidden_state toggle

###################################################################################################################################
####################                                                                                           ####################
####################                                        USER CONFIG                                        ####################
####################                                                                                           ####################
###################################################################################################################################

# start polybar
exec --no-startup-id polybar -r main

# keyboard adjustments
bindsym $mod+Num_Lock exec xdotool key Caps_Lock
exec --no-startup-id setxkbmap -option "ctrl:swap_rwin_rctl"
exec --no-startup-id setxkbmap -option "caps:numlock"

# file manager keyboard shortcut
bindsym $mod+e exec --no-startup-id nemo

# firefox keyboard shortcut
bindsym $mod+f exec --no-startup-id firefox

# xed keyboard shortcut
bindsym $mod+x exec --no-startup-id xed
bindsym $mod+shift+x exec --no-startup-id xed ~/.dotfiles/i3-config

# scratchpad keybind
bindsym $mod+Tab scratchpad show
bindsym $mod+Shift+space move scratchpad

# toggle borders
bindsym $mod+u border toggle

# screen backlight
# exec --no-startup-id brightnessctl set 21%    # this apparently fixed itself so i no longer need it
bindsym XF86MonBrightnessDown exec brightnessctl set 5-
bindsym Shift+XF86MonBrightnessDown exec brightnessctl set 10%-
bindsym XF86MonBrightnessUp exec brightnessctl set +5
bindsym Shift+XF86MonBrightnessUp exec brightnessctl set +10%

# keyboard backlight
bindsym XF86KbdBrightnessUp exec brightnessctl --device='smc::kbd_backlight' set +1%
bindsym XF86KbdBrightnessDown exec brightnessctl --device='smc::kbd_backlight' set 1%-

# control mpd
bindsym XF86AudioPlay exec mpc toggle
bindsym XF86AudioNext exec mpc next
bindsym XF86AudioPrev exec mpc prev
bindsym Shift+XF86AudioRaiseVolume exec mpc vol +1 && dunstify -t 1500 -r 2596 -u normal "Mpd $(mpc | grep volume | head --bytes=12)"
bindsym Shift+XF86AudioLowerVolume exec mpc vol -1 && dunstify -t 1500 -r 2596 -u normal "Mpd $(mpc | grep volume | head --bytes=12)"

# rofi keyboard shortcuts
bindsym $mod+d exec rofi -show drun

# alt tab
bindsym Mod1+Tab workspace back_and_forth

# screenshot
bindsym Shift+XF86Eject exec maim --select --hidecursor ~/Screenshots/"Screenshot from $(date '+%Y-%m-%d_%H-%M-%S')".png && dunstify -t 3000 -u normal "Screenshot saved on ~/Screenshots/ as Screenshot from $(date '+%Y-%m-%d_%H-%M-%S').png"
bindsym XF86Eject exec maim --hidecursor ~/Screenshots/"Screenshot from $(date '+%Y-%m-%d_%H-%M-%S')".png && dunstify -t 3000 -u normal "Screenshot saved on ~/Screenshots/ as Screenshot from $(date '+%Y-%m-%d_%H-%M-%S').png"

# better exit menu
mode "[l]ogout [r]eboot, [s]hutdown, loc[k]" {

    bindsym l exec i3-msg exit

    bindsym r exec systemctl reboot

    bindsym s exec systemctl poweroff

    bindsym k mode "default" ; exec i3lock -i /usr/share/backgrounds/noise_bg.png

    bindsym Escape mode "default"

    bindsym Return mode "default"

}

bindsym $mod+Shift+e mode "[l]ogout [r]eboot, [s]hutdown, loc[k]"

# start picom
exec --no-startup-id picom -b

# start feh to set wallpaper
# exec --no-startup-id feh --randomize --bg-fill ~/Pictures/Wallpapers/*     # polybar dynamically handles this now
bindsym $mod+Shift+b exec feh --randomize --bg-fill ~/Pictures/Wallpapers/1280x800/*

# start polkit
exec --no-startup-id lxpolkit

# start notification daemon
exec --no-startup-id dunst

# start touchegg
exec --no-startup-id cp -f ~/.dotfiles/i3-touchegg.conf ~/.config/touchegg/touchegg.conf
exec --no-startup-id touchegg

# disable focus follows mouse
focus_follows_mouse no

# disable focus wrapping
focus_wrapping no

# borders and titlebars
default_border pixel 1
default_floating_border normal 1

title_align center
hide_edge_borders smart

for_window [tiling] border pixel 1
for_window [floating] border normal 1
# for_window [all] title_window_icon on

# maybe someday i'll get dynamic windows working on this piece of shit
# assign [all] number "$(expr $(i3-msg -t get_workspaces | jq -r '.[] | select(.).num' | tail -n 1) + 1)"


# colors                border  backgr. text    indicator child_border
client.focused          #5294e2 #222222 #dfdfdf #222222   #5294e2
client.focused_inactive #222222 #111111 #666666 #222222   #222222
client.unfocused        #000000 #111111 #666666 #222222   #000000
client.urgent           #900000 #222222 #dfdfdf #900000   #900000
client.placeholder      #000000 #0c0c0c #ffffff #000000   #0c0c0c

client.background       #ffffff

# hide polybar
# exec --no-startup-id sleep 5 && ~/.config/polybar/hideIt.sh --name "polybar-main_LVDS1" --region 0x0+1280+2 -d top -p 0

# make anki behave itself
for_window [title="^Statistics$"] floating enable
for_window [title="^Edit Current$"] floating enable

# application finder floating
for_window [title="Application Finder"] floating enable

#test color
bindsym --release $mod+Shift+c exec xcolor --selection
